## 录入流程

### 审计当事人录入

| 名称       | 值               | 备注                                     |
| ---------- | ---------------- | ---------------------------------------- |
| 调用方法名 | register-auditee |                                          |
| 调用参数   | 1. 当事人姓名    |                                          |
| 返回值     | 当事人ID         | 创建成功则返回自动分配的ID，否则返回失败 |

调用示例：

```shell
peer chaincode invoke -c '{"Args": ["registerAuditee", "ZhanSan"]}'
```

### 规则录入

| 名称       | 值                                      | 备注                                          |
| ---------- | --------------------------------------- | --------------------------------------------- |
| 调用方法名 | register-rule                           |                                               |
| 调用参数   | 1. 规则名称 <br />2. 规则表达式相关参数 | 第2项为可变长参数，支持多个预言机合约同时验证 |
| 返回值     | 规则ID                                  | 创建成功则返回自动分配的ID，否则返回失败      |

调用示例：

```shell
peer chaincode invoke -c '{"Args": ["registerRule", "work time", "AND", "Time", "(>= 9) AND (<= 18)", "Location", "IN(39.9 116.3 1000)", "FaceRecognize", "", "ObjectRecognize", ""]}'
```

### 项目录入

| 名称       | 值                                                           | 备注                                                         |
| ---------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 调用方法名 | register-project                                             |                                                              |
| 调用参数   | 1. 项目名称 <br />2. 项目简要描述 <br />3. 审计当事人及相应规则录入 | 第3项为可变长参数，审计当事人及该当事人需要应用的规则成对出现，支持多个审计当事人的情况 |
| 返回值     | 项目ID                                                       | 创建成功则返回自动分配的ID，否则返回失败                     |

调用示例：

```shell
peer chaincode invoke -c '{"Args": ["registerProject", "POS Audit", "This is a bank project, used by bank employees to check if they did check the POS related bussiness themselfs within the specified time and location","123", "789"...]}'
```

### 审计事件新增

| 名称       | 值                                                           | 备注                                                         |
| ---------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 调用方法名 | add-event                                                    |                                                              |
| 调用参数   | 1. 审计当事人ID<br />2. 项目ID<br />3. 规则ID<br />4. 时间戳<br />5. 规则相关参数 | 第5项为可变长参数，具体长度视规则ID对应的表达式而定。        |
| 返回值     | 成功                                                         | 事件索引为同一个事件当事人在指定的项目和规则下，新增事件的编号 |

调用示例：

```shell
peer chaincode invoke -c '{"Args": ["addEvent", "123"，"456", "789", "1589532423", "Time", "2020-05-02T15:04:05.000Z", "Location", "39.901 116.299", "FaceRecognize", "/9j/4SMF...", "ObjectRecognize", "iVBORw0..."]}'
```

## 查询流程

### 获取指定审计当事人信息

根据审计当事人ID获取

```shell
peer chaincode invoke -c '{"Args": ["getAuditee", "123"]}'
```

### 获取指定项目信息

根据项目ID获取

```shell
peer chaincode invoke -c '{"Args": ["getProject", "456"]}'
```

### 获取指定规则信息

根据规则ID获取

```shell
peer chaincode invoke -c '{"Args": ["getRule", "789"]}'
```


### 获取所有合约运维人员信息

不需要参数

```shell
peer chaincode invoke -c '{"Args": ["getMaintainers"]}'
```

### 查询审计事件信息

根据当事人ID、项目ID及规则ID获取事件当事人在指定的项目和规则下的所有事件信息

```shell
peer chaincode invoke -c '{"Args": ["queryEvents", "123", "456", "789]}'
```
